<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rosenbrock with Nonlinear Constraints (2D) â€” Demo</title>
  <meta name="description" content="Example minimizing the 2D Rosenbrock function subject to nonlinear constraints. Includes run/plot instructions and figures." />

  <!-- MathJax for LaTeX rendering -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [["$","$"],["\\(","\\)"]], displayMath: [["$$","$$"],["\\[","\\]"]] }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <style>
    :root {
      --bg: #0f1116;
      --panel: #151922;
      --text: #e9edf3;
      --muted: #b9c0ce;
      --accent: #6ea8fe;
      --border: #263042;
      --code-bg: #0c1017;
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(180deg, var(--bg), #0a0d12 120%);
      color: var(--text);
      line-height: 1.6;
    }
    header {
      position: sticky; top: 0; z-index: 10;
      background: rgba(15,17,22,0.8);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border);
    }
    .container { max-width: 1500px; margin: 0 auto; padding: 1rem; }
    .title { margin: .2rem 0 0; font-size: clamp(1.6rem, 2.5vw, 2.2rem); }
    .subtitle { color: var(--muted); margin-top: .25rem; }

    main { padding-bottom: 3rem; }
    section { margin: 2rem 0; }
    h2 { font-size: 1.4rem; margin-bottom: .5rem; }

    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 1rem;
    }

    img.centered {
      display: block;         /* required for margin auto to work */
      margin-inline: auto;    /* center horizontally */
      height: auto;
      max-width: 100%;
      border-radius: 10px;
      border: 1px solid var(--border, #e5e7eb);
    }

    img.responsive { max-width: 50%; height: auto; display: block; border-radius: 10px; border: 1px solid var(--border); }

    pre, code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.95rem;
    }
    pre {
      position: relative;
      margin: 0.75rem 0; padding: 0.9rem 1rem; border-radius: 12px;
      background: var(--code-bg); border: 1px solid var(--border);
      overflow: auto;
    }

    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: var(--panel);
      color: var(--muted);
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 0.8rem;
      padding: 2px 8px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .copy-btn:hover {
      background: var(--accent);
      color: #fff;
    }

    .note { color: var(--muted); font-size: 0.95rem; }
    footer { border-top: 1px solid var(--border); padding: 1rem 0; color: var(--muted); text-align: center; }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1 class="title">Minimizing the Rosenbrock function with Nonlinear Constraints</h1>
      <p class="subtitle">Example minimizing the 2D Rosenbrock function with two external nonlinear constraints. This test case mimics a design optimization problem,
        where the objective function depends on two continuous parameters and is restricted by two constraints.
      </p>
    </div>
  </header>

  <main class="container">
    <section id="description" class="panel">
      <h2>Description</h2>
      <p>In this tutorial, the <strong>2D Rosenbrock function</strong> is minimized with two external nonlinear constraints. The optimization problem is:</p>
      <p>$$\text{minimize}\quad f(x_1, x_2) = (1 - x_1)^2 + 100\,(x_2 - x_1^2)^2$$</p>
      <p>$$\text{subject to}\quad x_2 - x_1^2 > 0,\quad (x_1 - 1)^3 - x_2 + 0.7 > 0,\\ -1.5 \le x_1 \le 1.5\;\;\text{and}\;\; -0.5 \le x_2 \le 2.5.$$</p>
      <p>The contour plot below shows the objective function; the shaded region indicates the feasible region.</p>
      <img src="./images/rosenbrock.png" alt="Rosenbrock function contours with feasible region shaded" class="responsive centered" />
    </section>

    <section id="xml-file" class="panel">
      <h2>Preparing the XML configuration file</h2>
      <p> Before running the optimization, we need to prepare an XML file. Each optimization study is denoted by the <code>&lt;optimization_study&gt;</code> tag in the XML file.</p>

      <p> Within this tag, we have a section where the general settings for the optimization study are specified. The parameters for this section are:</p>
      <ol>
        <li>The name of the problem: denoted by <code>&lt;name&gt;</code></li>
        <li>Problem dimension: denoted by <code>&lt;dimension&gt;</code></li>
        <li>Number of function evaluations: denoted by <code>&lt;number_of_function_evaluations&gt;</code>. This parameter specifies how many samples are allowed in the optimization process.</li>
        <li>Maximum number of inner iterations (optional): <code>&lt;max_number_of_inner_iterations&gt;</code>. This parameter specifies the number of inner iterations used while maximizing the acquisition function.</li>
        <li>Number of threads: denoted by <code>&lt;number_of_threads&gt;</code></li>
      </ol>

      <p>For our problem, the general settings section is:</p>
      <pre><code>&lt;general_settings&gt;
  &lt;name&gt;ROSENBROCK&lt;/name&gt;
  &lt;type&gt;Optimization&lt;/type&gt;
  &lt;dimension&gt;2&lt;/dimension&gt;
  &lt;number_of_function_evaluations&gt;50&lt;/number_of_function_evaluations&gt;
  &lt;max_number_of_inner_iterations&gt;200000&lt;/max_number_of_inner_iterations&gt;
&lt;/general_settings&gt;</code></pre>

      <p>The next step in the XML file is the section where optimization parameters are specified. This section is marked by the <code>&lt;optimization_parameters&gt;</code> tag.
      Within this section, each optimization parameter is specified using the <code>&lt;parameter&gt;</code> tag. For our example, the first optimization parameter is given as:</p>

      <pre><code>&lt;parameter&gt;
  &lt;name&gt;x1&lt;/name&gt;
  &lt;type&gt;REAL&lt;/type&gt;
  &lt;lower_bound&gt;-1.5&lt;/lower_bound&gt;
  &lt;upper_bound&gt;1.5&lt;/upper_bound&gt;
&lt;/parameter&gt;</code></pre>

      <p>The lower and upper bounds of the variable are set using the <code>&lt;lower_bound&gt;</code> and <code>&lt;upper_bound&gt;</code> tags. The parameter is allowed to change continuously during the optimization,
      so its type is set using the <code>&lt;type&gt;</code> tag.</p>

    </section>

    <section id="run" class="panel">
      <h2>Running the test case</h2>
      <p>Run the optimization from a terminal:</p>
      <pre><code>python runOptimization.py</code></pre>
      <p class="note">This generates <code>optimizationHistory.csv</code>, containing samples from the Design of Experiments (DoE) phase and the optimization iterations.</p>
    </section>

    <section id="plot" class="panel">
      <h2>Plotting the results</h2>
      <p>Create the result plots with:</p>
      <pre><code>python plotResults.py</code></pre>
      <img src="./images/optimizationResults.png" alt="Optimization trajectory and results for Rosenbrock with constraints" class="responsive centered" />
    </section>

    <section id="xml" class="panel">
      <h2>XML Input File</h2>
      <p>This XML file is the input configuration necessary for the optimization process. It must be prepared before running the optimization. It defines general settings, optimization parameters, the objective function, and constraints.</p>
      <pre><code class="language-xml">&lt;optimization_study&gt;
  &lt;general_settings&gt;
    &lt;name&gt;ROSENBROCK&lt;/name&gt;
    &lt;type&gt;Optimization&lt;/type&gt;
    &lt;dimension&gt;2&lt;/dimension&gt;
    &lt;number_of_function_evaluations&gt;50&lt;/number_of_function_evaluations&gt;
    &lt;max_number_of_inner_iterations&gt;200000&lt;/max_number_of_inner_iterations&gt;
  &lt;/general_settings&gt;

  &lt;optimization_parameters&gt;
    &lt;parameter&gt;
      &lt;name&gt;x1&lt;/name&gt;
      &lt;type&gt;REAL&lt;/type&gt;
      &lt;lower_bound&gt;-1.5&lt;/lower_bound&gt;
      &lt;upper_bound&gt;1.5&lt;/upper_bound&gt;
    &lt;/parameter&gt;
    &lt;parameter&gt;
      &lt;name&gt;x2&lt;/name&gt;
      &lt;type&gt;REAL&lt;/type&gt;
      &lt;lower_bound&gt;-0.5&lt;/lower_bound&gt;
      &lt;upper_bound&gt;2.5&lt;/upper_bound&gt;
    &lt;/parameter&gt;
  &lt;/optimization_parameters&gt;

  &lt;objective_function&gt;
    &lt;name&gt;RosenbrockFunction&lt;/name&gt;
    &lt;executable_filename&gt;calculateObjectiveFunction.py&lt;/executable_filename&gt;
    &lt;output_filename&gt;objectiveFunction.dat&lt;/output_filename&gt;
    &lt;training_data_filename&gt;Rosenbrock.csv&lt;/training_data_filename&gt;
    &lt;design_vector_filename&gt;dv.dat&lt;/design_vector_filename&gt;
  &lt;/objective_function&gt;

  &lt;constraint_function&gt;
    &lt;name&gt;Constraint1&lt;/name&gt;
    &lt;constraint_type&gt;gt&lt;/constraint_type&gt;
    &lt;constraint_value&gt;0.0&lt;/constraint_value&gt;
    &lt;executable_filename&gt;constraint1.py&lt;/executable_filename&gt;
    &lt;output_filename&gt;constraint1.dat&lt;/output_filename&gt;
    &lt;training_data_filename&gt;constraint1.csv&lt;/training_data_filename&gt;
    &lt;design_vector_filename&gt;dv.dat&lt;/design_vector_filename&gt;
  &lt;/constraint_function&gt;

  &lt;constraint_function&gt;
    &lt;name&gt;Constraint2&lt;/name&gt;
    &lt;constraint_type&gt;gt&lt;/constraint_type&gt;
    &lt;constraint_value&gt;0.0&lt;/constraint_value&gt;
    &lt;executable_filename&gt;constraint2.py&lt;/executable_filename&gt;
    &lt;output_filename&gt;constraint2.dat&lt;/output_filename&gt;
    &lt;training_data_filename&gt;constraint2.csv&lt;/training_data_filename&gt;
    &lt;design_vector_filename&gt;dv.dat&lt;/design_vector_filename&gt;
  &lt;/constraint_function&gt;
&lt;/optimization_study&gt;</code></pre>
      <p><a href="./optimization_study.xml" download>Download optimization_study.xml</a></p>
    </section>

  </main>

  <footer>
    <div class="container">&copy; 2025. All rights reserved.</div>
  </footer>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("pre").forEach((block) => {
      const button = document.createElement("button");
      button.className = "copy-btn";
      button.innerText = "Copy";

      button.addEventListener("click", () => {
        const code = block.querySelector("code");
        if (!code) return;
        navigator.clipboard.writeText(code.innerText).then(() => {
          button.innerText = "Copied!";
          setTimeout(() => (button.innerText = "Copy"), 1500);
        });
      });

      block.appendChild(button);
    });
  });
  </script>
</body>
</html>
